unit unConexao;

interface

uses
  SqlExpr, SysUtils;

type
  TConexao = class
  private
    FConnection: TSQLConnection;

    procedure ConfigurarConexao;

    function CriarQuery: TSQLQuery;
  public
    constructor Create;
    destructor Destroy; override;

    function GetConnection: TSQLConnection;
  end;

  const
    PATH_BANCO: string = 'C:\Program Files\Microsoft SQL Server\MSSQL14.MSSQLSERVER\MSSQL\DATA\ESCOLA.MDF';

implementation

{ TConexao }

procedure TConexao.ConfigurarConexao;
begin
  FConnection.DriverName                 := 'MSSQL';
  FConnection.Params.Values['DataBase']  := PATH_BANCO;
  FConnection.Params.Values['HostName']  := 'NCDEV28';
  FConnection.Params.Values['User_Name'] := 'sa';
  FConnection.Params.Values['Password']  := 'fcm123';
  FConnection.LoginPrompt                := False;
end;
              
constructor TConexao.Create;
begin
  FConnection := TSQLConnection.Create(nil);
end;

function TConexao.CriarQuery: TSQLQuery;
var
  VQuery: TSQLQuery;
begin
  VQuery := TSQLQuery.Create(nil);
  VQuery.SQLConnection := FConnection;

  Result := VQuery;
end;

destructor TConexao.Destroy;
begin
  FreeAndNil(FConnection);
  inherited;
end;

function TConexao.GetConnection: TSQLConnection;
begin
  Result := FConnection;
end;

end.
