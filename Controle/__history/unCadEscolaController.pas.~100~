unit unCadEscolaController;

interface

uses
  Windows, Dialogs, SysUtils, DateUtils, StdCtrls,
  Messages, unEscolaModelo, unEnumerado;

type
    TCadEscolaController = class
  private
    FEscolaModelo: TEscolaModelo;
    FAcao: TAcao;
    procedure SetEscolaModelo(const Value: TEscolaModelo);
    procedure SetAcao(const Value: TAcao);

  public
    constructor Create;
    destructor Destroy; override;

    function DevolverUltimoCodigo: Integer;
    function CarregarDadosParaClientDS: Boolean;
    function ValidarCampos: Boolean;
    function Gravar: Boolean;
    function StatusInsertEditClientDS: Boolean;
    function VerificaClientDSSeEstaAtivo: Boolean;

    procedure LimparCampos;
    procedure LimparDadosClientDS;
    procedure NovoCadastroClientDS;
    procedure AlterarClientDS;
    procedure ExcluirClientDS;
    procedure CancelarEdicaoClientDS;
    procedure CarregarEscola;
    procedure AbrirConexaoClientDS;
    procedure FecharConexaoClientDS;

    property EscolaModelo: TEscolaModelo read FEscolaModelo write SetEscolaModelo;
    property Acao: TAcao read FAcao write SetAcao;
  end;

implementation

uses
  unSistemaControle;

constructor TCadEscolaController.Create;
begin
  EscolaModelo := TEscolaModelo.Create;
end;

destructor TCadEscolaController.Destroy;
begin
  FreeAndNil(FEscolaModelo);
  inherited;
end;

function TCadEscolaController.VerificaClientDSSeEstaAtivo: Boolean;
begin
  Result := EscolaModelo.VerificaClientDSSeEstaAtivo;
end;

procedure TCadEscolaController.CancelarEdicaoClientDS;
begin
  EscolaModelo.CancelarEdicaoClientDS;
  Acao := tpCancelar;
end;

procedure TCadEscolaController.CarregarEscola;
begin
  EscolaModelo.CarregarEscola;
end;

procedure TCadEscolaController.NovoCadastroClientDS;
begin
  EscolaModelo.NovoCadastroClientDS;
  Acao := tpIncluir;
end;

procedure TCadEscolaController.SetAcao(const Value: TAcao);
begin
  FAcao := Value;
end;

procedure TCadEscolaController.SetEscolaModelo(const Value: TEscolaModelo);
begin
  FEscolaModelo := Value;
end;

function TCadEscolaController.StatusInsertEditClientDS: Boolean;
begin
  Result := EscolaModelo.StatusInsertEditClientDS;
end;

function TCadEscolaController.ValidarCampos: Boolean;
begin
  Result := EscolaModelo.ValidarCampos;
end;

//Método GRAVAR
function TCadEscolaController.CarregarDadosParaClientDS: Boolean;
begin
  Result := EscolaModelo.CarregarDadosParaClientDS;
end;

//Método CANCELAR
//Método EXCLUIR
procedure TCadEscolaController.ExcluirClientDS;
begin
  EscolaModelo.ExcluirClientDS;
  Acao := tpExcluir;
end;

procedure TCadEscolaController.FecharConexaoClientDS;
begin
  EscolaModelo.FecharConexaoClientDS;
end;

function TCadEscolaController.Gravar: Boolean;
begin
  Result := FEscolaModelo.Gravar;
end;

procedure TCadEscolaController.AbrirConexaoClientDS;
begin
  EscolaModelo.AbrirConexaoClientDS;
end;

procedure TCadEscolaController.AlterarClientDS;
begin
  EscolaModelo.AlterarClientDS;
  Acao := tpAlterar;
end;
//Método para o uso do ClientDataSet externamente

//Método para limpar os dados direto no ClientDataSet
procedure TCadEscolaController.LimparCampos;
begin
  EscolaModelo.LimparCampos;
end;

procedure TCadEscolaController.LimparDadosClientDS;
begin
  EscolaModelo.LimparDadosClientDS;
end;

//Método verificador do último CÓDIGO registrado no BD 
function TCadEscolaController.DevolverUltimoCodigo: Integer;
begin
  Result := EscolaModelo.DevolverUltimoCodigo;
end;
end.
