unit unCadastroEscolaController;

interface

uses DB, DBClient, SqlExpr, Windows, Dialogs, System, SysUtils, DateUtils;

type
  TDadosEscola = record
    Nome: string;
    DataCadastro: TDateTime;
    CEP: string;
    Rua: string;
    Numero: Integer;
    Complemento: string;
    Bairro: string;
    Cidade: string;
  end;

  TCadastroEscolaController = class
  public
    function Gravar(ADadosEscola: TDadosEscola): string;
  end;

implementation

uses
  unDados;

{ TCadastroEscolaController }
//
function TCadastroEscolaController.Gravar(ADadosEscola: TDadosEscola): string;
var
  FQuery: TSQLQuery;
begin
  FQuery := TSQLQuery.Create(nil);
  try
    FQuery.SQLConnection := fmdados.conexaoBDEscola;
    FQuery.SQL.Clear;
    FQuery.SQL.Add(Format(
        'INSERT INTO ESCOLA ' +
        '       (ESCNOME ' +
        '       ,ESCDATACAD ' +
        '       ,ESCENDRUA ' +
        '       ,ESCENDNUM ' +
        '       ,ESCENDCOMP ' +
        '       ,ESCENDBAIRRO ' +
        '       ,ESCENDCIDADE ' +
        '       ,ESCENDCEP) ' +
        ' VALUES ' +
        '       (''%s'', ''%s'', ''%s'', %d, ''%s'', ''%s'', ''%s'', ''%s'') ',
        [ADadosEscola.Nome, FormatDateTime('YYYY/MM/DD HH:MM:SS', ADadosEscola.DataCadastro),
         ADadosEscola.Rua, ADadosEscola.Numero, ADadosEscola.Complemento, ADadosEscola.Bairro,
         ADadosEscola.Cidade, ADadosEscola.CEP]));
    ShowMessage(IntToStr(FQuery.ExecSQL(True)));
  finally
    FreeAndNil(FQuery);
  end;

end;

end.
